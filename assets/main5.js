function n(s,e,o){return(1-o)*s+o*e}function i(){const s=document.querySelector(".preloader"),e=s.querySelector(".preloader__progress"),o=document.querySelectorAll("video"),r=o.length;let l=0;o.forEach((t,a)=>{switch(t.tagName.toLowerCase()){case"video":const c=t.getAttribute("data-src");t.setAttribute("src",c),t.addEventListener("loadeddata",()=>{t.readyState>=3&&(l+=1,h(s,e,r,l))})}})}function h(s,e,o,r){const l=r/o*100;e.innerText=`${l}%`,l===100&&s.classList.add("preloader--loaded")}function d(s){const e=s.querySelectorAll("a"),o=s.querySelectorAll("video");e.forEach((r,l)=>{r.addEventListener("mouseleave",()=>{r.removeAttribute("active")}),r.addEventListener("mouseover",()=>{r.setAttribute("active",""),o.forEach((t,a)=>{a===l?(t.style.setProperty("--video-height","100%"),t.play()):(t.style.setProperty("--video-height","0%"),t.pause())})})})}class u{constructor(){this.scrollElement=document.querySelector("[smooth-scroll]"),this.currentScrollPos=0,this.targetScrollPos=0,this.scrollEase=.1,this.workGalleryElements=document.querySelectorAll(".work"),this.links=document.querySelectorAll("a"),this.template=document.querySelector("[data-template]"),this._initSmoothScroll(),this._update(),this._createPage()}_update(){this._smoothScroll(),this.frame=requestAnimationFrame(this._update.bind(this))}_createPage(){i(),this.links.forEach(async e=>await this._watchPageTransitions(e)),this.workGalleryElements.length>0&&this.workGalleryElements.forEach(e=>d(e))}_initSmoothScroll(){document.body.style.height=`${this.scrollElement.getBoundingClientRect().height}px`}_smoothScroll(){this.targetScrollPos=window.scrollY,this.currentScrollPos=n(this.currentScrollPos,this.targetScrollPos,this.scrollEase),this.currentScrollPos=parseFloat(this.currentScrollPos.toFixed(2));const e=`translate3d(0, ${this.currentScrollPos*-1}px, 0)`;this.scrollElement.style.transform=e}async _watchPageTransitions(e){e.addEventListener("click",async o=>{try{o.preventDefault();const r=await fetch(e.href);if(r.status===200){const l=await r.text();window.history.pushState({},"",e.href);const t=document.createElement("div");t.innerHTML=l;const a=t.querySelector("[data-template]");this.template.innerHTML=a.innerHTML,this._createPage()}}catch{}})}}new u;
